---
title: "Biodiversity is NY State Counties"
author: "Abigail Kaurin"
output: github_document
---

## Summary

Write-up of your project and findings go here. 
Think of this as the text of your presentation. 
The length should be roughly 5 minutes when read out loud.
Although pacing varies, a 5-minute speech is roughly 750 words. 
To use the word count addin, select the text you want to count the words of (probably this is the 
Summary section of this document, go to Addins, and select the `Word count` addin).
This addin counts words using two different algorithms, but the results should be similar and as long as you're in the ballpark of 750 words, you're good! 
The addin will ignore code chunks and only count the words in prose.

You can also load your data here and present any analysis results / plots, but I strongly urge you to keep that to a minimum (maybe only the most important graphic, if you have one you can choose). 
And make sure to hide your code with  `echo = FALSE` unless the point you are trying to make is about the code itself.
Your results with proper output and graphics go in your presentation, this space is for a brief summary of your project.


```{r load-data, echo = FALSE}
# load data here, if you like

library(tidyverse)
library(dplyr)
library(datasets)
library(readr)

biodiversity <- read.csv("/cloud/project/data/biodiversity-by-county-distribution-of-animals-plants-and-natural-communities-1.csv")

```


***This shows the distribution of biodiversity by county from highest to lowest.***

```{r}
library(dplyr)

biodiversity_count <- biodiversity %>%
  group_by(County) %>%
  summarise(Unique_Species_Count = n_distinct(Scientific.Name))

biodiversity_count <- biodiversity_count %>%
  arrange(desc(Unique_Species_Count))

print(biodiversity_count)
```

***Suffox, Essex, and Orange are the top three most diverse counties.***



***This distribution shows biodiversity of counties from lowest bio diverse county to the highest:***

```{r}

library(dplyr)

biodiversity_count <- biodiversity %>%
  group_by(County) %>%
  summarise(Unique_Species_Count = n_distinct(Scientific.Name))

biodiversity_count <- biodiversity_count %>%
  arrange(Unique_Species_Count)

print(biodiversity_count)
```


***From here I will remove `Counties Unknown`, `not listed`,	`Lake Erie Open Waters`,	`Lake Ontario Open Waters`, `Atlantic Ocean`, and `Long Island Sound`, as they do not count as official counties:***

```{r only counties}

biodiversity_count <- biodiversity %>%
  group_by(County) %>%
  summarise(Unique_Species_Count = n_distinct(Scientific.Name))

biodiversity_count <- biodiversity_count %>%
  arrange(Unique_Species_Count)

non_county_entries <- c("Counties Unknown", "not listed", "Lake Erie Open Waters", 
                        "Lake Ontario Open Waters", "Atlantic Ocean and Long Island Sound")

biodiversity_count <- biodiversity_count %>%
  filter(!(County %in% non_county_entries))

print(biodiversity_count)
```

***Based on this information, `New York`, `Montgomery`, and `Kings` counties rank with the lowest recorded biodiversity, with Houghton University's Allegany county not far behind them at the 7th lowest position.***


Visualization of biodiversity distribution:

```{r}

library(ggplot2)

biodiversity_count <- biodiversity %>%
  group_by(County) %>%
  summarise(Unique_Species_Count = n_distinct(Scientific.Name))

biodiversity_count <- biodiversity_count %>%
  arrange(Unique_Species_Count)


ggplot(biodiversity_count, aes(x = reorder(County, Unique_Species_Count), y = Unique_Species_Count)) +
  geom_histogram(stat = "identity", fill = "pink", width = 0.7) +
  coord_flip() + 
  labs(title = "Distribution of Biodiversity Across NYS Counties",
       x = "County",
       y = "Unique Species Count") +
  theme_minimal()



```

***Based on this information, Suffox county contains the greatest variability of species by far compared to other counties.***


```{r}
endangered_species <- biodiversity %>%
  filter(NY.Listing.Status == "Endangered" | 
           Federal.Listing.Status == "Endangered" |
           State.Conservation.Rank == "S1")

endangered_count <- endangered_species %>%
  group_by(County) %>%
  summarise(Endangered_Species_Count = n_distinct(Scientific.Name))

endangered_count <- endangered_count %>%
  arrange(desc(Endangered_Species_Count))

print(endangered_count)
```

***Based on this table, Suffolk, Richmond, and Nassau counties carry the most endangered species in NY. Interestingly Allegany county ranks 60th of counties with endangered species, carrying only 10.***


***Here is a visualization of endangered species by county:***

```{r endangered-by-county}


endangered_count <- endangered_count %>%
  arrange(desc(Endangered_Species_Count))


ggplot(endangered_count, aes(x = reorder(County, Endangered_Species_Count), 
                             y = Endangered_Species_Count)) +
  geom_bar(stat = "identity", fill = "pink", width = 0.7) +
  coord_flip() +  
  labs(title = "Endangered Species by County",
       x = "County",
       y = "Number of Endangered Species") +
  theme_minimal()


```

***This visualization gives a better idea of the distribution, and Suffolk appears to have more than double the amount of endangered species compared to other counties.***



## Presentation

My presentation can be found [here](presentation/presentation.html).

## Data 

Include a citation for your data here. 
See http://libraryguides.vu.edu.au/c.php?g=386501&p=4347840 for guidance on proper citation for datasets. 
If you got your data off the web, make sure to note the retrieval date.

## References

List any references here. You should, at a minimum, list your data source.

